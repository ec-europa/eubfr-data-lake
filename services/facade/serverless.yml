service: facade

plugins:
  - serverless-webpack
  - serverless-offline #serverless-offline needs to be last in the list

custom:
  webpackIncludeModules: true
  eubfrEnvironment: ${env:EUBFR_ENV, 'dev'}
  EUBFRbucketName: eubfr-${self:provider.stage}
  serverless-offline:
    port: 4000

package:
  individually: true

provider:
  name: aws
  runtime: nodejs6.10
  # role: EUBFRs3ProxyRole
  stage: ${opt:stage, file(../../config.json):stage, 'dev'}
  region: ${opt:region, file(../../config.json):region, 'eu-central-1'}
  deploymentBucket:
    name: eubfr-${self:custom.eubfrEnvironment}-deploy
  stackTags:
    ENV: ${self:custom.eubfrEnvironment}
  versionFunctions: false
  stackPolicy:
    - Effect: Allow
      Principal: "*"
      Action: "Update:*"
      Resource: "*"

functions:
  put-projects:
    handler: src/put.handler
    events:
      - http:
          path: projects
          method: put
          cors: true
